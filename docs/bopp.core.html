<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>bopp.core documentation</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="css/highlight.css" /><script type="text/javascript" src="js/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Bopp</span> <span class="project-version">0.1.0</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>bopp</span></div></div></li><li class="depth-2 branch current"><a href="bopp.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-2 branch"><a href="bopp.error-handling.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>error-handling</span></div></a></li><li class="depth-2 branch"><a href="bopp.helper-functions.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>helper-functions</span></div></a></li><li class="depth-2"><a href="bopp.program-transformations.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>program-transformations</span></div></a></li><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree" style="top: -145px;"><span class="top" style="height: 154px;"></span><span class="bottom"></span></span><span>examples</span></div></div></li><li class="depth-2 branch"><a href="examples.chaos.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>chaos</span></div></a></li><li class="depth-2 branch"><a href="examples.hmm.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>hmm</span></div></a></li><li class="depth-2 branch"><a href="examples.opt.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>opt</span></div></a></li><li class="depth-2"><a href="examples.simple-bimodal.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>simple-bimodal</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="bopp.core.html#var-defopt"><div class="inner"><span>defopt</span></div></a></li><li class="depth-1"><a href="bopp.core.html#var-doopt"><div class="inner"><span>doopt</span></div></a></li><li class="depth-1"><a href="bopp.core.html#var-opt"><div class="inner"><span>opt</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">bopp.core</h1><div class="doc"><pre class="plaintext">User interface for BOPP
</pre></div><div class="public anchor" id="var-defopt"><h3>defopt</h3><h4 class="type">macro</h4><div class="usage"><code>(defopt name &amp; args)</code></div><div class="doc"><pre class="plaintext">Binds variable to a BOPP query. Synatx is the
 same as Anglican's defquery, except that an
 additional input is specified to dictate the
 variables to be optimized.

Example:

(defopt opt-query
   &lt;docstring&gt;
   [y] [theta]
   (let [a (sample (normal 0 10))
         theta (sample (normal a 20))
         b (sample (normal a (* theta theta)))]
     (observe (normal (* a theta) (* b b)) y)
     [a b]))


For more details please see the README and the
paper.  <a href="https://github.com/twgr/bopp/blob/master/README.md">https://github.com/twgr/bopp/blob/master/README.md</a>
<a href="http://papers.nips.cc/paper/6421-bayesian-optimization-for-probabilistic-programs">http://papers.nips.cc/paper/6421-bayesian-optimization-for-probabilistic-programs</a></pre></div></div><div class="public anchor" id="var-doopt"><h3>doopt</h3><div class="usage"><code>(doopt algorithm opt-query opt-query-args num-samples &amp; {:keys [speed-option bo-options opt-type opt-program-transformation opt-sample-summarizer opt-bo-target-transformation num-particles acq-opt-num-starts ais-num-steps ais-start-exponent ais-end-exponent output-extractor f-theta-inf], :or {speed-option :fast, opt-type :mmap, ais-start-exponent 0.001, ais-end-exponent 10, output-extractor get-result-vector, f-theta-inf -100000.0}})</code></div><div class="doc"><pre class="plaintext">Calls BOPP on a target query as defined by defopt, returning a lazy
 infinite sequence of increasingly optimal estimates.

For more details please see the README and the
paper.  <a href="https://github.com/twgr/bopp/blob/master/README.md">https://github.com/twgr/bopp/blob/master/README.md</a>
<a href="http://papers.nips.cc/paper/6421-bayesian-optimization-for-probabilistic-programs">http://papers.nips.cc/paper/6421-bayesian-optimization-for-probabilistic-programs</a>

Input:
  algorithm ... Inference algorithm
    [:smc, :pcascade, :importance]
  opt-query ... Query to be optimized, defined by defopt.
  opt-query-args ... Arguments of opt-query.
  num-samples ... Number of samples for constructing the estimator to be
    optimized

Optional keyword arguments:
  Speed option:
    speed-option ... Set the default options to a set of pre-tuned values to
      be able to switch between the different modes of running depending on
      speed. Can be overriden by user post-hoc.
      [:careful, :fast] (Default: :fast)

  Bayesian optimization (BO) options:
    bo-options ... look at documentation of Deodorant, this should be a map
      with those options, i.e.:

        {:initial-points &lt;initial-points&gt;
         :num-scaling-thetas &lt;num-scaling-thetas&gt;
         :num-initial-points &lt;num-initial-points&gt;
         :cov-fn-form &lt;cov-fn-form&gt;
         ... etc.}

      You only need to provide options whose defaults that you want to
      override.

      (Default:
        if :speed-option is :careful
          {:hmc-num-leapfrog-steps 5
           :hmc-num-mcmc-steps 50
           :hmc-num-opt-steps 15
           :hmc-num-chains 8
           :hmc-max-gps 50}

        if :speed-option is :fast
          {:hmc-num-leapfrog-steps 2
           :hmc-num-mcmc-steps 20
           :hmc-num-opt-steps 10
           :hmc-num-chains 4
           :hmc-max-gps 20})

  Optimization options:
    opt-type ... Optimization type. Use :custom to customize the
      optimization; must provide opt-program-transformation,
      opt-sample-summarizer, opt-bo-target-transformation in this case.
      [:mmap, :ml2, :risk-minimization :custom] (Default: :mmap)
    opt-program-transformation ... Custom program transformation for
      optimization.
      [nil, :mmap, :ml2] (Default: nil)
    opt-sample-summarizer ... Custom sample summarizer for optimizer. Takes
      in a sequence of Anglican samples, outputs target scalar for BO.
      (Default: nil; Suggested: anglican.inference/log-marginal)
    opt-bo-target-transformation ... Custom BO target transformation for
      optimization. Takes in BO target, outputs alternative target.
      (Default: nil; Suggested: identity, - for minimization)

  Inference options:
    num-particles ... Number of particles during inference.
      (Default: num-samples)

  Acquisition optimization/AIS options:
    acq-opt-num-starts ... Number of parallel optimizations to prevent
      multimodality. (Default: 4 if :speed-option is :fast 16 if :careful)
    ais-num-steps ... Number of MCMC steps performed during acquisition
      function optimization.
      (Default: (max 100 (int (* 2 (/ num-samples acq-opt-num-starts)))))
    ais-start-exponent ... Start exponent for annealed importance sampling
      (Default: 0.001)
    ais-end-exponent ... End exponent for annealed importance sampling
      (Default: 10)

  Other options
    output-extractor ... Takes in an Anglican sample, returns its output.
      (Default: #(into [] (anglican.state/get-result sample));
       Alternatives: anglican.state/get-result, anglican.state/get-predicts)
    f-theta-inf ... Replace -Infinity during BO by this. (Default: -1e5)

Output:
  Lazy list of increasingly optimal (in the MMAP sense) triples
  (opt-vars, log-marginal, program-results):
    opt-vars ... optimization variables
    log-marginal ... the log marginal likelihood p(observes, opt-vars)
    program-results ... program results associated with opt-vars

See paper for details.</pre></div></div><div class="public anchor" id="var-opt"><h3>opt</h3><h4 class="type">macro</h4><div class="usage"><code>(opt &amp; args)</code></div><div class="doc"><pre class="plaintext"></pre></div></div></div></body></html>